name: Download Multiple Podcast Episodes

on:
  workflow_dispatch:
    inputs:
      episode_urls:
        description: 'Paste episode URLs (one per line)'
        required: true
        default: |
          https://example.com/episode1.mp3
          https://example.com/episode2.mp3

jobs:
  download_podcasts:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Create download folder
        run: mkdir -p downloads

      - name: Download all podcast episodes
        run: |
          echo "${{ github.event.inputs.episode_urls }}" | while read -r url; do
            if [[ ! -z "$url" ]]; then
              filename=$(basename "$url" | cut -d'?' -f1)
              echo "Downloading: $url"
              curl -L "$url" -o "downloads/$filename"
            fi
          done

      - name: Zip all downloaded episodes
        run: zip -r podcast-episodes.zip downloads/

      - name: Upload zipped podcasts as artifact
        uses: actions/upload-artifact@v4
        with:
          name: podcast-episodes
          path: podcast-episodes.zip
